<ng-container *ngIf="!confirmStep">
  <ng-container *ngIf="flowStep < 0">
    <div class="v-center justify-content-between close-panel" mat-dialog-close>
      <i class="d-block i-icon i-close bgc-dark custom-close-i"></i>
    </div>
    <div class="v-center justify-content-between mt-2">
      <h1 mat-dialog-title class="custom-dlg-title deep-primary-color m-0" translate>
        Just one moment!
      </h1>
    </div>
    <div class="v-center justify-content-between mt-2">
      <label class="deep-primary-color" translate>
        We'd love to gather your feedback. Why would you like to cancel?
      </label>
    </div>
    <mat-dialog-content>
      <div class="form-group">
        <div class="reason_table mt-5 mb-5">
          <div class='reason' *ngFor="let button of reasonButtons; let i = index" (click)='selectReason(button)'>
            <input class="custom-radio" type="radio" [id]="'select-reason-' + i" [name]="'select-reason-' + i"
              [checked]="isSelected(button)">
            <label [class.primary-color]="isSelected(button)" class="deep-primary-color f-6 font-weight-bold" id="cancel-reason-{{i}}"
              for="'select-reason-' + i">{{ button | translate }}</label>
          </div>
        </div>
      </div>
      <ng-container *ngIf="selectedReasonId === 5">
        <div class="mt-3">
          <p class="mute-color f-4" translate>
            What is the reason you would like to cancel your subscription?
          </p>
        </div>
        <div class="functionality-field mb-4">
          <textarea [(ngModel)]="reasonFeedback" class="form-control mb-2" placeholder="" rows="4" required>
          </textarea>
          <ng-container *ngIf="invalidReason">
            <span class="error c-red f-3" translate>Describe the reason for cancellation</span>
          </ng-container>
        </div>
      </ng-container>
    </mat-dialog-content>
    <mat-dialog-actions align="center">
      <div class="text-toolbar v-center mt-2 w-100">
        <button class="custom-cancel-btn btn btn-white f-6 font-weight-bold ml-auto mr-2" type="button"
          (click)="closeDialog()">
          {{ 'Cancel' | translate }}
        </button>
        <button class="custom-next-btn btn btn-white f-6 font-weight-bold" type="button"
          (click)="nextAction()">
          {{ 'Next' | translate }}
        </button>
      </div>
    </mat-dialog-actions>
  </ng-container>
  <ng-container *ngIf="selectedReasonId === 0 && flowStep === 0">
    <div class="v-center justify-content-between close-panel" mat-dialog-close>
      <i class="d-block i-icon i-close bgc-dark custom-close-i"></i>
    </div>
    <div class="v-center justify-content-between close-panel" mat-dialog-close>
      <i class="d-block i-icon i-close bgc-dark custom-close-i"></i>
    </div>
    <div class="mt-2">
      <h1 mat-dialog-title class="custom-dlg-sub-title third-color text-center m-0" translate>
        Do you need a different plan?
      </h1>
    </div>
    <div class="mt-3">
      <p class="mute-color text-center" translate>
        Perhaps there's a better plan to fit your needs
      </p>
    </div>
    <mat-dialog-content>
      <div class="plans-field">
        <div class="plan">
          <div class="mb-2">
            <span class="plan-name font-weight-bold green-color" translate>Lite</span>
            <span class="ml-3 deep-primary-color font-weight-bold">
              $ <span class="plan-name">29</span> / {{ 'Month' | translate }}
            </span>
          </div>
          <div class="mb-3">
            {{ 'Best for business and growth leaders newer to their business' | translate }}
          </div>
          <a class="primary-color font-weight-bold text-decoration-none" [routerLink]="['/profile/subscription']"
            target="_blank">
            {{ 'Learn more' | translate }}
          </a>
        </div>
        <div class="plan">
          <div class="mb-2">
            <span class="plan-name font-weight-bold orange-color" translate>Pro</span>
            <span class="ml-3 deep-primary-color font-weight-bold">
              $ <span class="plan-name">49</span> / {{ 'Month' | translate }}
            </span>
          </div>
          <div class="mb-3">
            {{ 'Best for business leaders and enterpreneurs with one business and focus' | translate }}
          </div>
          <a class="primary-color font-weight-bold text-decoration-none" [routerLink]="['/profile/subscription']"
            target="_blank">
            {{ 'Learn more' | translate }}
          </a>
        </div>
        <div class="plan last">
          <div class="mb-2">
            <span class="plan-name font-weight-bold purple-color" translate>Elite</span>
            <span class="ml-3 deep-primary-color font-weight-bold">
              $ <span class="plan-name">99</span> / {{ 'Month' | translate }}
            </span>
          </div>
          <div class="mb-3">
            {{ 'Best for Enterpreneurs, Influencers, and people looking to become Growth Leaders' | translate }}
          </div>
          <a class="primary-color font-weight-bold text-decoration-none" [routerLink]="['/profile/subscription']"
            target="_blank">
            {{ 'Learn more' | translate }}
          </a>
        </div>
      </div>
    </mat-dialog-content>
    <mat-dialog-actions align="center">
      <div class="text-toolbar v-center mt-2 w-100">
        <button class="custom-cancel-btn btn btn-white f-6 font-weight-bold ml-auto mr-2" type="button"
          (click)="backAction()">
          {{ 'Back' | translate }}
        </button>
        <button class="custom-next-btn btn btn-white f-6 font-weight-bold" type="button" (click)="confirmAction()">
          {{ 'No thanks, I like to cancel' | translate }}
        </button>
      </div>
    </mat-dialog-actions>
  </ng-container>
  <ng-container *ngIf="(selectedReasonId === 1 || selectedReasonId  ===2) && flowStep === 0">
    <div class="v-center justify-content-between close-panel" mat-dialog-close>
      <i class="d-block i-icon i-close bgc-dark custom-close-i"></i>
    </div>
    <div class="mt-2">
      <h1 mat-dialog-title class="custom-dlg-sub-title third-color text-center m-0" translate>
        Book a free One-on-One online meeting with a crmgrow Expert
      </h1>
    </div>
    <mat-dialog-content>
      <div class="msg-field">
        <div class="mt-5 mb-4">
          <img [src]="sspaService.toAsset('img/cancellation/customer-support.svg')" />
        </div>
        <div class="msg-content mb-4 deep-primary-color font-weight-bold">
          <div>
            {{ 'We’d love to help you learn how to leverage the powerful tool suite of crmgrow' | translate }}&nbsp;
            {{ 'Before “cutting the cord”, please feel welcome to book a free One-on-One meeting with one of our experts' | translate }}
          </div>
        </div>
        <a class="btn btn-primary f-6 font-weight-bold text-decoration-none" [href]="chatWithUs" target="_blank">
          {{ 'Chat with us' | translate }}
        </a>
      </div>
    </mat-dialog-content>
    <mat-dialog-actions align="center">
      <div class="text-toolbar v-center mt-5 mb-4 w-100">
        <button class="custom-cancel-btn btn btn-white f-6 font-weight-bold ml-auto mr-2" type="button"
          (click)="backAction()">
          {{ 'Back' | translate }}
        </button>
        <button class="custom-next-btn btn btn-white f-6 font-weight-bold" type="button"
          (click)="selectedReasonId === 1?confirmAction():nextAction()">
          {{ 'No thanks, I like to cancel' | translate }}
        </button>
      </div>
    </mat-dialog-actions>
  </ng-container>
  <ng-container *ngIf="selectedReasonId === 2 && flowStep === 1">
    <div class="v-center justify-content-between close-panel" mat-dialog-close>
      <i class="d-block i-icon i-close bgc-dark custom-close-i"></i>
    </div>
    <div class="mt-2">
      <h1 mat-dialog-title class="custom-dlg-sub-title third-color m-0" translate>
        Feature request
      </h1>
    </div>
    <div class="mt-3">
      <p class="deep-primary-color font-weight-bold f-6">
        {{ 'Help us make the improvements you need' | translate }}
      </p>
    </div>
    <div class="mt-3">
      <p class="mute-color f-4">
        {{ 'What features of functionality that you need, is missing from crmgrow?' | translate }}
      </p>
    </div>
    <form #actionForm="ngForm" (ngSubmit)="submitted = true; actionForm.form.valid ? confirmAction() : false"
      [class.was-validated]="submitted">
      <mat-dialog-content>
        <div class="functionality-field">
          <textarea [(ngModel)]="reasonFeedback" name="reasonFeedback" class="form-control mb-2" placeholder="" rows="4"
            required>
          </textarea>
        </div>
      </mat-dialog-content>
      <mat-dialog-actions align="center">
        <div class="text-toolbar v-center mt-4 mb-3 w-100">
          <button class="custom-cancel-btn btn btn-white f-6 font-weight-bold ml-auto mr-2" type="button"
            (click)="backAction()">
            {{ 'Back' | translate }}
          </button>
          <button class="custom-submit-btn btn btn-primary f-6 font-weight-bold" type="submit"
            [class.loading]="saving">
            {{ 'Submit' | translate }}
          </button>
        </div>
      </mat-dialog-actions>
    </form>
  </ng-container>
  <ng-container *ngIf="selectedReasonId === 3 && flowStep === 0">
    <div class="v-center justify-content-between close-panel" mat-dialog-close>
      <i class="d-block i-icon i-close bgc-dark custom-close-i"></i>
    </div>
    <div class="mt-2">
      <h1 mat-dialog-title class="custom-dlg-sub-title third-color m-0" translate>
        We value your feedback
      </h1>
    </div>
    <div class="mt-2">
      <p class="deep-primary-color font-weight-bold f-6">
        {{ 'Help us improve our product to better suit your requirements' | translate }}
      </p>
    </div>
    <div class="mt-4">
      <p class="mute-color f-4">
        {{ 'What product are you using and why are you considering switching?' | translate }}
      </p>
    </div>
    <form #actionForm="ngForm" (ngSubmit)="submitted = true; actionForm.form.valid ? confirmAction() : false"
      [class.was-validated]="submitted">
      <mat-dialog-content>
        <div class="functionality-field">
          <textarea [(ngModel)]="reasonFeedback" name="reasonFeedback" class="form-control mb-2" placeholder="" rows="4"
            required>
          </textarea>
        </div>
      </mat-dialog-content>
      <mat-dialog-actions align="center">
        <div class="text-toolbar v-center mt-4 mb-3 w-100">
          <button class="custom-cancel-btn btn btn-white f-6 font-weight-bold ml-auto mr-2" type="button"
            (click)="backAction()">
            {{ 'Back' | translate }}
          </button>
          <button class="custom-submit-btn btn btn-primary f-6 font-weight-bold" type="submit"
            [class.loading]="saving">
            {{ 'Submit' | translate }}
          </button>
        </div>
      </mat-dialog-actions>
    </form>
  </ng-container>
</ng-container>
<ng-container *ngIf="confirmStep">
  <div class="v-center justify-content-between close-panel" mat-dialog-close
    [class.d-none]="loadingCancelAccount || loadingSleepAccount">
    <i class="d-block i-icon i-close bgc-dark custom-close-i"></i>
  </div>
  <div class="v-center justify-content-between mt-2">
    <h1 mat-dialog-title class="custom-dlg-sub-title deep-primary-color m-0" translate>
      Wait... don't lose your data!
    </h1>
  </div>
  <div class="v-center justify-content-between mt-2">
    <label class="third-color">
      {{ 'Would you like to pause your account and keep your data?' | translate }}&nbsp;
      {{ 'We only charge a small fee for storing your data.' | translate }}
    </label>
  </div>
  <mat-dialog-content>
    <div class="form-group">
      <div class="ml-5 mt-4 mb-5 f-6">
        <div class='w-100 mb-2' (click)='selectKeepData(true)'>
          <input class="custom-radio" type="radio" [id]="select-keep" [name]="select-keep"
            [checked]="isKeepDataSelected">
          <label [class.primary-color]="isKeepDataSelected" class="deep-primary-color f-6 font-weight-bold"
            for="select-keep" [translateParams]="{plan: '$4.99/m'}" translate>
            Pause my account and keep my data for only plan
          </label>
        </div>
        <div class='w-100 mb-2' (click)='selectKeepData(false)'>
          <input class="custom-radio" type="radio" [id]="select-keep" [name]="select-keep"
            [checked]="!isKeepDataSelected">
          <label [class.primary-color]="!isKeepDataSelected" class="deep-primary-color f-6 font-weight-bold"
            for="select-keep" [translateParams]="{period: '60'}" translate>I
            Want to cancel. I understand that my data will be deleted after period days
          </label>
        </div>
      </div>
    </div>
    <hr />
  </mat-dialog-content>
  <mat-dialog-actions align="center">
    <div class="text-toolbar v-center mt-2 w-100">
      <button class="custom-cancel-btn btn btn-white f-6 font-weight-bold ml-auto mr-2" type="button"
        (click)="backAction()" [class.disabled]="loadingCancelAccount || loadingSleepAccount">
        {{ 'Back' | translate }}
      </button>
      <button class="custom-next-btn btn btn-white f-6 font-weight-bold" type="button"
        [class.loading]="loadingCancelAccount || loadingSleepAccount" (click)="cancelAction()">
        {{ 'Confirm' | translate }}
      </button>
    </div>
  </mat-dialog-actions>
</ng-container>
<ng-container *ngIf="isCanceled">
  <div class="mt-3">
    <div *ngIf="isKeepDataSelected" class="v-center justify-content-between close-panel" mat-dialog-close>
      <i class="d-block i-icon i-close bgc-dark custom-close-i"></i>
    </div>
    <h1 mat-dialog-title class="custom-dlg-sub-title third-color text-center m-0">
      {{ (isKeepDataSelected ? 'Account Paused' : 'Subscription Canceled') | translate }}
    </h1>
  </div>
  <mat-dialog-content>
    <div class="msg-field">
      <div class="mt-4 mb-4">
        <img *ngIf="!isKeepDataSelected" [src]="sspaService.toAsset('img/cancellation/cancel.svg')" height="75px"
          width="75px" />
        <img *ngIf="isKeepDataSelected" [src]="sspaService.toAsset('img/cancellation/pause.svg')" height="75px" width="75px" />
      </div>
      <div class="msg-content mb-4 third-color font-weight-bold">
        <ng-container *ngIf="isKeepDataSelected">
          <div>{{ 'Your account has been paused' | translate }}</div>
          <div>{{ 'You can always resume your plan the via Billing screen' | translate }}</div>
        </ng-container>
        <ng-container *ngIf="!isKeepDataSelected">
          <div>{{ 'Thank you for using crmgrow' | translate }}</div>
          <div>{{ 'We hope you’ll join us again soon!' | translate }}</div>
        </ng-container>
      </div>
      <div class="mb-4">
        <a *ngIf="!isKeepDataSelected" class="btn btn-primary f-6 font-weight-bold text-decoration-none" name="return-to-billing"
          (click)="completeCancelAccount()">
          {{ 'Return to billing' | translate }}
        </a>
        <ng-container *ngIf="isKeepDataSelected">
          <a class="btn btn-primary f-6 font-weight-bold text-decoration-none" name="return-to-billing" href="https://crmgrow.com/pricing.html">
            {{ 'Return to billing' | translate }}
          </a>
        </ng-container>
      </div>
    </div>
  </mat-dialog-content>
</ng-container>
